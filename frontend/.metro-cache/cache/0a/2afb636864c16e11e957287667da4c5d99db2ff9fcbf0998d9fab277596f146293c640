{"dependencies":[{"name":"expo-notifications","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"nrBDtkRVez7cBhLzyaRjl+xVfvE=","exportNames":["*"],"imports":1}},{"name":"expo-device","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":38,"index":91}}],"key":"bBpmAhO1g++sdeUzQmFVGoQIVwg=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":133},"end":{"line":4,"column":69,"index":202}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":203},"end":{"line":5,"column":26,"index":229}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.registerForPushNotifications = registerForPushNotifications;\n  exports.registerTokenWithServer = registerTokenWithServer;\n  exports.setupPushNotifications = setupPushNotifications;\n  var _expoNotifications = require(_dependencyMap[0], \"expo-notifications\");\n  var Notifications = _interopNamespace(_expoNotifications);\n  var _expoDevice = require(_dependencyMap[1], \"expo-device\");\n  var Device = _interopNamespace(_expoDevice);\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[2], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[3], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _axios = require(_dependencyMap[4], \"axios\");\n  var axios = _interopDefault(_axios);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n\n  /**\n   * Request notification permissions and get Expo push token\n   */\n  async function registerForPushNotifications() {\n    try {\n      // Check if we're on a physical device\n      if (!Device.isDevice) {\n        console.log('Push notifications require a physical device');\n        return null;\n      }\n\n      // Check existing permissions\n      const {\n        status: existingStatus\n      } = await Notifications.getPermissionsAsync();\n      let finalStatus = existingStatus;\n\n      // Request permissions if not already granted\n      if (existingStatus !== 'granted') {\n        const {\n          status\n        } = await Notifications.requestPermissionsAsync();\n        finalStatus = status;\n      }\n      if (finalStatus !== 'granted') {\n        console.log('Failed to get push notification permission');\n        return null;\n      }\n\n      // Get Expo push token\n      const tokenData = await Notifications.getExpoPushTokenAsync({\n        projectId: 'safeguard-app'\n      });\n      const token = tokenData.data;\n      console.log('Expo Push Token:', token);\n\n      // Configure Android notification channel\n      if (Platform.default.OS === 'android') {\n        await Notifications.setNotificationChannelAsync('default', {\n          name: 'SafeGuard Alerts',\n          importance: Notifications.AndroidImportance.MAX,\n          vibrationPattern: [0, 250, 250, 250],\n          lightColor: '#EF4444',\n          sound: 'default'\n        });\n        await Notifications.setNotificationChannelAsync('emergency', {\n          name: 'Emergency Alerts',\n          importance: Notifications.AndroidImportance.MAX,\n          vibrationPattern: [0, 500, 250, 500],\n          lightColor: '#FF0000',\n          sound: 'default',\n          bypassDnd: true\n        });\n      }\n      return token;\n    } catch (error) {\n      console.error('Error registering for push notifications:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Register push token with backend server\n   */\n  async function registerTokenWithServer(token) {\n    try {\n      const authToken = await AsyncStorage.default.getItem('auth_token');\n      if (!authToken) {\n        console.log('No auth token available to register push token');\n        return false;\n      }\n      await axios.default.post(`${BACKEND_URL}/api/push-token/register`, token, {\n        headers: {\n          Authorization: `Bearer ${authToken}`,\n          'Content-Type': 'application/json'\n        }\n      });\n      await AsyncStorage.default.setItem('push_token', token);\n      console.log('Push token registered with server successfully');\n      return true;\n    } catch (error) {\n      console.error('Failed to register push token with server:', error.response?.data || error.message);\n      return false;\n    }\n  }\n\n  /**\n   * Full push notification setup - call after login\n   */\n  async function setupPushNotifications() {\n    const token = await registerForPushNotifications();\n    if (token) {\n      return await registerTokenWithServer(token);\n    }\n    return false;\n  }\n});","lineCount":138,"map":[[27,2,12,0,"exports"],[27,9,12,0],[27,10,12,0,"registerForPushNotifications"],[27,38,12,0],[27,41,12,0,"registerForPushNotifications"],[27,69,12,0],[28,2,73,0,"exports"],[28,9,73,0],[28,10,73,0,"registerTokenWithServer"],[28,33,73,0],[28,36,73,0,"registerTokenWithServer"],[28,59,73,0],[29,2,104,0,"exports"],[29,9,104,0],[29,10,104,0,"setupPushNotifications"],[29,32,104,0],[29,35,104,0,"setupPushNotifications"],[29,57,104,0],[30,2,1,0],[30,6,1,0,"_expoNotifications"],[30,24,1,0],[30,27,1,0,"require"],[30,34,1,0],[30,35,1,0,"_dependencyMap"],[30,49,1,0],[31,2,1,0],[31,6,1,0,"Notifications"],[31,19,1,0],[31,22,1,0,"_interopNamespace"],[31,39,1,0],[31,40,1,0,"_expoNotifications"],[31,58,1,0],[32,2,2,0],[32,6,2,0,"_expoDevice"],[32,17,2,0],[32,20,2,0,"require"],[32,27,2,0],[32,28,2,0,"_dependencyMap"],[32,42,2,0],[33,2,2,0],[33,6,2,0,"Device"],[33,12,2,0],[33,15,2,0,"_interopNamespace"],[33,32,2,0],[33,33,2,0,"_expoDevice"],[33,44,2,0],[34,2,2,38],[34,6,2,38,"_reactNativeWebDistExportsPlatform"],[34,40,2,38],[34,43,2,38,"require"],[34,50,2,38],[34,51,2,38,"_dependencyMap"],[34,65,2,38],[35,2,2,38],[35,6,2,38,"Platform"],[35,14,2,38],[35,17,2,38,"_interopDefault"],[35,32,2,38],[35,33,2,38,"_reactNativeWebDistExportsPlatform"],[35,67,2,38],[36,2,4,0],[36,6,4,0,"_reactNativeAsyncStorageAsyncStorage"],[36,42,4,0],[36,45,4,0,"require"],[36,52,4,0],[36,53,4,0,"_dependencyMap"],[36,67,4,0],[37,2,4,0],[37,6,4,0,"AsyncStorage"],[37,18,4,0],[37,21,4,0,"_interopDefault"],[37,36,4,0],[37,37,4,0,"_reactNativeAsyncStorageAsyncStorage"],[37,73,4,0],[38,2,5,0],[38,6,5,0,"_axios"],[38,12,5,0],[38,15,5,0,"require"],[38,22,5,0],[38,23,5,0,"_dependencyMap"],[38,37,5,0],[39,2,5,0],[39,6,5,0,"axios"],[39,11,5,0],[39,14,5,0,"_interopDefault"],[39,29,5,0],[39,30,5,0,"_axios"],[39,36,5,0],[40,2,7,0],[40,8,7,6,"BACKEND_URL"],[40,19,7,17],[40,22,7,20,"process"],[40,29,7,27],[40,30,7,28,"env"],[40,33,7,31],[40,34,7,32,"EXPO_PUBLIC_BACKEND_URL"],[40,57,7,55],[42,2,9,0],[43,0,10,0],[44,0,11,0],[45,2,12,7],[45,17,12,22,"registerForPushNotifications"],[45,45,12,50,"registerForPushNotifications"],[45,46,12,50],[45,48,12,77],[46,4,13,2],[46,8,13,6],[47,6,14,4],[48,6,15,4],[48,10,15,8],[48,11,15,9,"Device"],[48,17,15,15],[48,18,15,16,"isDevice"],[48,26,15,24],[48,28,15,26],[49,8,16,6,"console"],[49,15,16,13],[49,16,16,14,"log"],[49,19,16,17],[49,20,16,18],[49,66,16,64],[49,67,16,65],[50,8,17,6],[50,15,17,13],[50,19,17,17],[51,6,18,4],[53,6,20,4],[54,6,21,4],[54,12,21,10],[55,8,21,12,"status"],[55,14,21,18],[55,16,21,20,"existingStatus"],[56,6,21,35],[56,7,21,36],[56,10,21,39],[56,16,21,45,"Notifications"],[56,29,21,58],[56,30,21,59,"getPermissionsAsync"],[56,49,21,78],[56,50,21,79],[56,51,21,80],[57,6,22,4],[57,10,22,8,"finalStatus"],[57,21,22,19],[57,24,22,22,"existingStatus"],[57,38,22,36],[59,6,24,4],[60,6,25,4],[60,10,25,8,"existingStatus"],[60,24,25,22],[60,29,25,27],[60,38,25,36],[60,40,25,38],[61,8,26,6],[61,14,26,12],[62,10,26,14,"status"],[63,8,26,21],[63,9,26,22],[63,12,26,25],[63,18,26,31,"Notifications"],[63,31,26,44],[63,32,26,45,"requestPermissionsAsync"],[63,55,26,68],[63,56,26,69],[63,57,26,70],[64,8,27,6,"finalStatus"],[64,19,27,17],[64,22,27,20,"status"],[64,28,27,26],[65,6,28,4],[66,6,30,4],[66,10,30,8,"finalStatus"],[66,21,30,19],[66,26,30,24],[66,35,30,33],[66,37,30,35],[67,8,31,6,"console"],[67,15,31,13],[67,16,31,14,"log"],[67,19,31,17],[67,20,31,18],[67,64,31,62],[67,65,31,63],[68,8,32,6],[68,15,32,13],[68,19,32,17],[69,6,33,4],[71,6,35,4],[72,6,36,4],[72,12,36,10,"tokenData"],[72,21,36,19],[72,24,36,22],[72,30,36,28,"Notifications"],[72,43,36,41],[72,44,36,42,"getExpoPushTokenAsync"],[72,65,36,63],[72,66,36,64],[73,8,37,6,"projectId"],[73,17,37,15],[73,19,37,17],[74,6,38,4],[74,7,38,5],[74,8,38,6],[75,6,40,4],[75,12,40,10,"token"],[75,17,40,15],[75,20,40,18,"tokenData"],[75,29,40,27],[75,30,40,28,"data"],[75,34,40,32],[76,6,41,4,"console"],[76,13,41,11],[76,14,41,12,"log"],[76,17,41,15],[76,18,41,16],[76,36,41,34],[76,38,41,36,"token"],[76,43,41,41],[76,44,41,42],[78,6,43,4],[79,6,44,4],[79,10,44,8,"Platform"],[79,18,44,16],[79,19,44,16,"default"],[79,26,44,16],[79,27,44,17,"OS"],[79,29,44,19],[79,34,44,24],[79,43,44,33],[79,45,44,35],[80,8,45,6],[80,14,45,12,"Notifications"],[80,27,45,25],[80,28,45,26,"setNotificationChannelAsync"],[80,55,45,53],[80,56,45,54],[80,65,45,63],[80,67,45,65],[81,10,46,8,"name"],[81,14,46,12],[81,16,46,14],[81,34,46,32],[82,10,47,8,"importance"],[82,20,47,18],[82,22,47,20,"Notifications"],[82,35,47,33],[82,36,47,34,"AndroidImportance"],[82,53,47,51],[82,54,47,52,"MAX"],[82,57,47,55],[83,10,48,8,"vibrationPattern"],[83,26,48,24],[83,28,48,26],[83,29,48,27],[83,30,48,28],[83,32,48,30],[83,35,48,33],[83,37,48,35],[83,40,48,38],[83,42,48,40],[83,45,48,43],[83,46,48,44],[84,10,49,8,"lightColor"],[84,20,49,18],[84,22,49,20],[84,31,49,29],[85,10,50,8,"sound"],[85,15,50,13],[85,17,50,15],[86,8,51,6],[86,9,51,7],[86,10,51,8],[87,8,53,6],[87,14,53,12,"Notifications"],[87,27,53,25],[87,28,53,26,"setNotificationChannelAsync"],[87,55,53,53],[87,56,53,54],[87,67,53,65],[87,69,53,67],[88,10,54,8,"name"],[88,14,54,12],[88,16,54,14],[88,34,54,32],[89,10,55,8,"importance"],[89,20,55,18],[89,22,55,20,"Notifications"],[89,35,55,33],[89,36,55,34,"AndroidImportance"],[89,53,55,51],[89,54,55,52,"MAX"],[89,57,55,55],[90,10,56,8,"vibrationPattern"],[90,26,56,24],[90,28,56,26],[90,29,56,27],[90,30,56,28],[90,32,56,30],[90,35,56,33],[90,37,56,35],[90,40,56,38],[90,42,56,40],[90,45,56,43],[90,46,56,44],[91,10,57,8,"lightColor"],[91,20,57,18],[91,22,57,20],[91,31,57,29],[92,10,58,8,"sound"],[92,15,58,13],[92,17,58,15],[92,26,58,24],[93,10,59,8,"bypassDnd"],[93,19,59,17],[93,21,59,19],[94,8,60,6],[94,9,60,7],[94,10,60,8],[95,6,61,4],[96,6,63,4],[96,13,63,11,"token"],[96,18,63,16],[97,4,64,2],[97,5,64,3],[97,6,64,4],[97,13,64,11,"error"],[97,18,64,16],[97,20,64,18],[98,6,65,4,"console"],[98,13,65,11],[98,14,65,12,"error"],[98,19,65,17],[98,20,65,18],[98,63,65,61],[98,65,65,63,"error"],[98,70,65,68],[98,71,65,69],[99,6,66,4],[99,13,66,11],[99,17,66,15],[100,4,67,2],[101,2,68,0],[103,2,70,0],[104,0,71,0],[105,0,72,0],[106,2,73,7],[106,17,73,22,"registerTokenWithServer"],[106,40,73,45,"registerTokenWithServer"],[106,41,73,46,"token"],[106,46,73,59],[106,48,73,79],[107,4,74,2],[107,8,74,6],[108,6,75,4],[108,12,75,10,"authToken"],[108,21,75,19],[108,24,75,22],[108,30,75,28,"AsyncStorage"],[108,42,75,40],[108,43,75,40,"default"],[108,50,75,40],[108,51,75,41,"getItem"],[108,58,75,48],[108,59,75,49],[108,71,75,61],[108,72,75,62],[109,6,76,4],[109,10,76,8],[109,11,76,9,"authToken"],[109,20,76,18],[109,22,76,20],[110,8,77,6,"console"],[110,15,77,13],[110,16,77,14,"log"],[110,19,77,17],[110,20,77,18],[110,68,77,66],[110,69,77,67],[111,8,78,6],[111,15,78,13],[111,20,78,18],[112,6,79,4],[113,6,81,4],[113,12,81,10,"axios"],[113,17,81,15],[113,18,81,15,"default"],[113,25,81,15],[113,26,81,16,"post"],[113,30,81,20],[113,31,82,6],[113,34,82,9,"BACKEND_URL"],[113,45,82,20],[113,71,82,46],[113,73,83,6,"token"],[113,78,83,11],[113,80,84,6],[114,8,85,8,"headers"],[114,15,85,15],[114,17,85,17],[115,10,86,10,"Authorization"],[115,23,86,23],[115,25,86,25],[115,35,86,35,"authToken"],[115,44,86,44],[115,46,86,46],[116,10,87,10],[116,24,87,24],[116,26,87,26],[117,8,88,8],[118,6,89,6],[118,7,90,4],[118,8,90,5],[119,6,92,4],[119,12,92,10,"AsyncStorage"],[119,24,92,22],[119,25,92,22,"default"],[119,32,92,22],[119,33,92,23,"setItem"],[119,40,92,30],[119,41,92,31],[119,53,92,43],[119,55,92,45,"token"],[119,60,92,50],[119,61,92,51],[120,6,93,4,"console"],[120,13,93,11],[120,14,93,12,"log"],[120,17,93,15],[120,18,93,16],[120,66,93,64],[120,67,93,65],[121,6,94,4],[121,13,94,11],[121,17,94,15],[122,4,95,2],[122,5,95,3],[122,6,95,4],[122,13,95,11,"error"],[122,18,95,21],[122,20,95,23],[123,6,96,4,"console"],[123,13,96,11],[123,14,96,12,"error"],[123,19,96,17],[123,20,96,18],[123,64,96,62],[123,66,96,64,"error"],[123,71,96,69],[123,72,96,70,"response"],[123,80,96,78],[123,82,96,80,"data"],[123,86,96,84],[123,90,96,88,"error"],[123,95,96,93],[123,96,96,94,"message"],[123,103,96,101],[123,104,96,102],[124,6,97,4],[124,13,97,11],[124,18,97,16],[125,4,98,2],[126,2,99,0],[128,2,101,0],[129,0,102,0],[130,0,103,0],[131,2,104,7],[131,17,104,22,"setupPushNotifications"],[131,39,104,44,"setupPushNotifications"],[131,40,104,44],[131,42,104,65],[132,4,105,2],[132,10,105,8,"token"],[132,15,105,13],[132,18,105,16],[132,24,105,22,"registerForPushNotifications"],[132,52,105,50],[132,53,105,51],[132,54,105,52],[133,4,107,2],[133,8,107,6,"token"],[133,13,107,11],[133,15,107,13],[134,6,108,4],[134,13,108,11],[134,19,108,17,"registerTokenWithServer"],[134,42,108,40],[134,43,108,41,"token"],[134,48,108,46],[134,49,108,47],[135,4,109,2],[136,4,111,2],[136,11,111,9],[136,16,111,14],[137,2,112,0],[138,0,112,1],[138,3]],"functionMap":{"names":["<global>","registerForPushNotifications","registerTokenWithServer","setupPushNotifications"],"mappings":"AAA;OCW;CDwD;OEK;CF0B;OGK;CHQ"},"hasCjsExports":false},"type":"js/module"}]}